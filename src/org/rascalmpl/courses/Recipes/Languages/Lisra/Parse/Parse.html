<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">

<!---- DO NOT EDIT: HTML generated by CourseCompiler ---->


<head>
<title>Recipes/Languages/Lisra/Parse</title>

<meta name="description" content="Recipes/Languages/Lisra/Parse:  Parsing a Lisp expression.">

<meta name="keywords" content="Recipes/Languages/Lisra/Parse, Rascal, meta-programming, software analysis, software transformation">
<link type="text/css" rel="stylesheet" href="/prelude.css"/>
<link type="text/css" rel="stylesheet" href="/jquery.autocomplete.css"/>
<script type="text/javascript" src="/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="/jquery.colorbox-min.js"></script>
<script type="text/javascript" src="/jquery.cookie.js"></script>
<script type="text/javascript" src="/jquery.jstree.js"></script>
<script type="text/javascript" src="/jquery.autocomplete.js"></script>
<script type="text/javascript" src="/jquery.history.js"></script>
<script type="text/javascript" src="/globals.js"></script>
<script type="text/javascript" src="/prelude.js"></script>
<script type="text/javascript" src="/Recipes/course.js"></script>

</head>
<body>
<table id="container"><tr><td id="tdlogo"><a id="tutorAction" href="/index.html"><img id="leftIcon" height="40" width="40" src="/images/rascal-tutor-small.png"></a></td><td id="tdsearch">
<div id="searchBox">
  <form method="GET" id="searchForm" action="/search"> 
    <img id="searchIcon" height="20" width="20" src="/images/magnify.png">
    <input type="hidden" name="concept" value="Recipes/Languages/Lisra/Parse">
    <input type="text" id="searchField" name="term" autocomplete="off"><br />
    <div id="popups"></div>
  </form>
</div>
         </td></tr><tr><td id="tdnav">
<a id="navPanePlaceHolder" href="/Recipes/navigate.html" >Navigation</a>
<script type="text/javascript"> var navigationPaneSource="/Recipes/navigate.html"; </script></td><td id="tdconcept">
<div id="conceptPane">

<div id="Name">
<span class="sectionHead">Name</span> <a href="/Recipes/Recipes.html">Recipes</a>/<a href="/Recipes/Languages/Languages.html">Languages</a>/<a href="/Recipes/Languages/Lisra/Lisra.html">Lisra</a>/<a href="/Recipes/Languages/Lisra/Parse/Parse.html">Parse</a>
</div>

<div id="Synopsis">
<span class="sectionHead">Synopsis</span>  Parsing a Lisp expression.

</div>

	                       
                           
                           
                           
<div id="Description">
<span class="sectionHead">Description</span>  Give the Lisp <a href="/Recipes/Languages/Lisra/Syntax/Syntax.html">Syntax</a>, we can now apply it to parse textual Lisp expressions
 and convert them to the runtime representation <code>Lval</code>.
  <pre class="listing">module demo::lang::Lisra::Parse

import Prelude;
import demo::lang::Lisra::Syntax;
import demo::lang::Lisra::Runtime;

public Lval parse(str txt) = build(parse(#LispExp, txt));                          <img src="/images/1.png">

// Build Abstract Synax Tree: Transform a LispExp to an Lval

public Lval build((LispExp)`&lt;IntegerLiteral il>`) = Integer(toInt("&lt;il>"));        <img src="/images/2.png">
public Lval build((LispExp)`&lt;AtomExp at>`)        = Atom("&lt;at>");                  <img src="/images/3.png">
public Lval build((LispExp)`( &lt;LispExp* lst> )`)  = List([build(le) | le &lt;- lst]); <img src="/images/4.png">

</pre> First we define the actual <code>parse</code> function (<img src="/images/1.png">): it takes a string as argument and returns an <code>Lval</code>.
 It proceeds in two steps:
 <ul><li> First the text is parsed using <code>parse(#LispExp, txt)</code>. The result is parse tree.</li>
<li> Next, the auxiliary function <code>build</code> is used to transform the parse tree to an <code>Lval</code>.</li>
</ul> Function <code>build</code> (<img src="/images/2.png">--<img src="/images/4.png">) is defined in cases, for the various parse tree forms.
 Fortunately, we do not have to spell out the details of the parse tree, but we can use concrete
 patterns instead. For instance, the argument pattern 
 <pre class="listing">(LispExp)`&lt;IntegerLiteral il>`
</pre> says:
 <ul><li> Match something of type <code>LispExp</code>.</li>
<li> It should be an <code>IntegerLiteral</code> and bind it to a variable <code>il</code>.</li>
</ul> More precisely, the text between backquotes should be a string that can be parsed according to the non-terminal
 that precedes it (<code>LispExp</code> in this example). This is illustrated by the list case where the parentheses appear in the concrete pattern:
 <pre class="listing">(LispExp)`( &lt;LispExp* lst> )`
</pre> The right-hand sides of (<img src="/images/2.png">--<img src="/images/4.png">) deserve some attention:
 <ul><li> In <img src="/images/2.png"> the argument <code>il</code> is a <i>parse tree</i> (!!) that represents an integer literal.   We first convert it to a string using string interpolation (<code>"&lt;il>"</code>) and then convert it to an integer.
</li>
<li> In <img src="/images/3.png"> the text of the atom is reconstructed in a similar fashion.</li>
<li> In <img src="/images/4.png"> the concrete list elements in <code>lst</code> are converted one-by-one using build and are then used to   create a new <code>List</code> value.
</li>
</ul>
</div>

  	                       
<div id="Examples">
<span class="sectionHead">Examples</span>  <pre class="screen"><span class="prompt">rascal></span>import demo::lang::Lisra::Parse;
|rascal://demo::lang::Lisra::Parse|: Java compilation failed due to with classpath [/Users/jurgenv/Test/eclipse/plugins/org.eclipse.equinox.launcher_1.3.0.v20130327-1440.jar]: package org.eclipse.imp.pdb.facts.type does not exist
<span class="prompt">rascal></span>import demo::lang::Lisra::Runtime;
ok
<span class="prompt">rascal></span>parse(&quot;1&quot;);
|stdin:///|(0,5,&lt;1,0>,&lt;1,5>): Undeclared variable: parse
<span class="prompt">rascal></span>parse(&quot;x&quot;);
|stdin:///|(0,5,&lt;1,0>,&lt;1,5>): Undeclared variable: parse
<span class="prompt">rascal></span>parse(&quot;(+ 5 7)&quot;);
|stdin:///|(0,5,&lt;1,0>,&lt;1,5>): Undeclared variable: parse
</pre>
</div>

  	                       
  	                       
  	                       
<a id="tutorAction" href="/index.html"><img id="leftIcon" height="40" width="40" src="/images/rascal-tutor-small.png"></a><div id="editMenu">[<a id="editAction" href="/edit?concept=Recipes/Languages/Lisra/Parse&new=false"><b>Edit</b></a>] | 
               [<a id="newAction" href="/edit?concept=Recipes/Languages/Lisra/Parse&new=true"><b>New Subconcept</b></a>] |
               [<a id="compileAction" href="/compile?name=Recipes"><b>Recompile Course</b></a>] |
               [<a id="warnAction" href="/Recipes/warnings.html"><b>Warnings</b></a>]<span class="inlineError"> 4 warnings in this concept</span></div>
<span class="editMenuFooter">Is this page unclear, or have you spotted an error? Please add a comment below and help us to improve it. For all other questions and remarks, visit <a href="http://ask.rascal-mpl.org">ask.rascal-mpl.org</a>. </span>
</div>
</td></tr></table>
</body>
</html>